# Австрийские типы счётов (Rechnungsmerkmale) - Объяснение

## Каждый счет в системе соответствует определенному налоговому сценарию

### Созданные примеры счётов в БД:

#### 1️⃣ **2026001 - INLAND (Инланд) - Внутригосударственная поставка**
- **Клиент**: ALEMIRA GROUP (Словакия) → но счет создан как INLAND
- **Сумма**: €100 (SubTotal) + €20 (VAT 20%) = €120
- **Налоговая ставка**: 20% (стандартная австрийская ставка)
- **Особенности**:
  - Стандартный счет для поставки внутри Австрии
  - Обязательно должны быть поля:
    - ✓ UID (VAT ID) поставщика
    - ✓ UID клиента
    - ✓ Детальное описание услуг/товаров
    - ✓ НДС выделен отдельной строкой
  - **Когда использовать**: Поставка товаров/услуг в Австрию

---

#### 2️⃣ **2026002 - EXPORT (Экспорт) - Экспортный счет**
- **Клиент**: ALERO Handels GmbH (Австрия)
- **Сумма**: €100 (SubTotal) + €0 (Tax-free) = €100
- **Налоговая ставка**: 0% (не облагается НДС)
- **Особенности**:
  - Полная освобождение от НДС в Австрии
  - Обязательно должны быть поля:
    - ✓ Пометка "Exportrechnung" или "Ausfuhrlieferung"
    - ✓ Страна назначения
    - ✓ Документы, подтверждающие экспорт
    - ✓ Наименование "Export invoice" или "Tax-free export"
  - **Когда использовать**: Поставка товаров за пределы ЕС

---

#### 3️⃣ **2026003 - INTRA-EU SALE (Внутриобщиночная поставка)**
- **Клиент**: ALERO Handels GmbH (Австрия)
- **Сумма**: €120 (SubTotal) + €0 = €120
- **Налоговая ставка**: 0% в Австрии (обратное взимание на клиента)
- **Особенности**:
  - Поставка между компаниями внутри ЕС
  - Обязательно должны быть поля:
    - ✓ UID обеих сторон
    - ✓ Пометка "Innergemeinschaftliche Lieferung" (Intra-EU supply)
    - ✓ Страна доставки
    - ✓ Налог платит ПОКУПАТЕЛЬ в своей стране
  - **Когда использовать**: B2B поставка в другую страну ЕС

---

#### 4️⃣ **2026004 - REVERSE CHARGE (Обратное взимание)**
- **Клиент**: ANDREI GIGI (Австрия)
- **Сумма**: €150 (SubTotal) + €0 = €150
- **Налоговая ставка**: 0% в счете (обязательство на клиента)
- **Особенности**:
  - НДС не взимается поставщиком, а платится клиентом
  - Обязательно должны быть поля:
    - ✓ Пометка "Reverse Charge applies"
    - ✓ Указание, что клиент платит налог
    - ✓ UID обеих сторон
    - ✓ Условия использования reverse charge
  - **Когда использовать**:
    - B2B услуги (консультинг, IT-услуги)
    - Поставки из-за рубежа
    - Трансграничные услуги

---

#### 5️⃣ **2026005 - KLEINUNTERNEHMER (Малый предприниматель)**
- **Клиент**: ANDREI GIGI (Австрия)
- **Сумма**: €80 (SubTotal) + €0 = €80
- **Налоговая ставка**: 0% (законодательная льгота)
- **Особенности**:
  - Маленькие компании с годовым оборотом < €35,000
  - Обязательно должны быть поля:
    - ✓ Пометка "Kleinunternehmer gem. § 6 Abs. 1 Z 27 UStG"
    - ✓ НЕЛЬЗЯ выстав НДС
    - ✓ НЕЛЬЗЯ иметь input VAT вычет
    - ✓ Упрощенная документация
  - **Когда использовать**: Малые компании на упрощенной системе

---

## Поле `InvoiceType` в таблице `Invoices`:
```sql
InvoiceType INTEGER (0 = Domestic, 1 = Export, 2 = IntraEUSale, 3 = ReverseCharge, 4 = SmallBusinessExemption)
IsReverseCharge BOOLEAN
IsSmallBusinessExemption BOOLEAN
IsTaxFreeExport BOOLEAN
IsIntraEUSale BOOLEAN
```

## Требования к формату счета (Rechnungsmerkmale):

Все счета ОБЯЗАНЫ содержать:
1. ✓ Уникальный номер счета (в нашей системе `InvoiceNumber`)
2. ✓ Дату счета
3. ✓ Дату срока платежа
4. ✓ UID (VAT ID) поставщика
5. ✓ Полное имя/адрес поставщика
6. ✓ Полное имя/адрес клиента
7. ✓ Описание товаров/услуг
8. ✓ Единицы измерения и количество
9. ✓ Цену за единицу и сумму
10. ✓ НДС выделен отдельно (если применяется)
11. ✓ Итоговую сумму к оплате

## Специфичные требования по типу:

**DOMESTIC (Inland)**:
- UID покупателя (если есть)
- 20% НДС (или 10%/13% для сниженных ставок)

**EXPORT**:
- Номер таможенного документа
- Пометка об экспорте
- 0% НДС

**INTRA-EU**:
- UID обеих сторон ОБЯЗАТЕЛЕН
- Пометка о поставке внутри ЕС
- 0% НДС в AT (reverse charge)

**REVERSE CHARGE**:
- Четкое указание на reverse charge
- UID обеих сторон
- 0% НДС в счете

**KLEINUNTERNEHMER**:
- Обязательный текст о льготе
- НИКОГДА НЕ может быть НДС
- НИКОГДА НЕ может быть VAT ID в счете

---

## Следующие шаги для PDF-шаблонов:

1. Создать 5 разных шаблонов PDF для каждого типа
2. Каждый шаблон должен содержать нужные поля
3. В FinalReportService выбирать правильный шаблон по InvoiceType
4. Добавить специальные тексты (пометки) для каждого типа

